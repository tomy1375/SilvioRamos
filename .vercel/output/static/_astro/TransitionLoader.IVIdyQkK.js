import{j as i}from"./jsx-runtime.D_zvdyIk.js";import{r as d}from"./index.Dy6lLLXr.js";function h(){const[u,m]=d.useState(!1),[l,r]=d.useState(""),[v,s]=d.useState(!1);return d.useEffect(()=>{const f=()=>{const e=sessionStorage.getItem("navigationAction"),a=(sessionStorage.getItem("navigationTarget")||"").startsWith("/admin");e==="login"?(r("Iniciando sesión..."),s(!0)):e==="logout"?(r("Cerrando sesión..."),s(!0)):a?(r("Cargando..."),s(!0)):(r("Cargando..."),s(!1))},n=e=>{e.detail&&e.detail.message?(r(e.detail.message),s(!0)):f(),m(!0)},o=()=>{m(!1)};document.addEventListener("showLoader",n),document.addEventListener("hideLoader",o),document.addEventListener("astro:before-preparation",n),document.addEventListener("astro:after-preparation",o),document.addEventListener("astro:before-swap",n),document.addEventListener("astro:after-swap",o),document.addEventListener("astro:page-load",()=>{o();const e=window.location.pathname;e==="/login"&&sessionStorage.getItem("navigationAction")==="logout"&&(console.log("Limpiando estado de logout en página de login"),setTimeout(()=>{sessionStorage.removeItem("navigationAction"),sessionStorage.removeItem("navigationTarget")},500)),!e.startsWith("/admin")&&e!=="/login"&&(sessionStorage.removeItem("navigationAction"),sessionStorage.removeItem("navigationTarget"))});const g=e=>{if(e.target.closest("a")&&e.target.closest("a").href)try{const t=e.target.closest("a"),a=new URL(t.href);a.origin===window.location.origin&&(sessionStorage.setItem("navigationTarget",a.pathname),!t.id.includes("logout")&&!a.pathname.startsWith("/admin")&&a.pathname!=="/login"&&sessionStorage.removeItem("navigationAction"))}catch(t){console.error("Error al procesar URL:",t)}};document.addEventListener("click",g,!0);const c=()=>{document.querySelectorAll("*").forEach(t=>{t.childNodes.length===1&&t.childNodes[0].nodeType===Node.TEXT_NODE&&t.textContent.trim()==="redirieigiendo"&&(t.style.display="none")})};return c(),document.addEventListener("astro:page-load",c),()=>{document.removeEventListener("showLoader",n),document.removeEventListener("hideLoader",o),document.removeEventListener("astro:before-preparation",n),document.removeEventListener("astro:after-preparation",o),document.removeEventListener("astro:before-swap",n),document.removeEventListener("astro:after-swap",o),document.removeEventListener("astro:page-load",o),document.removeEventListener("click",g,!0),document.removeEventListener("astro:page-load",c)}},[]),!u||!v||!l?null:i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-90",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"}),i.jsx("p",{className:"mt-4 text-lg font-medium text-white",children:l})]})})}export{h as default};
